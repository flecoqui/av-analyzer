ARG AV_WEBAPP_PORT_HTTP=8084
ARG AV_WEBAPP_STORAGE_RESULT_URL=""
ARG AV_WEBAPP_STORAGE_RESULT_SAS_TOKEN=""
ARG AV_WEBAPP_STORAGE_RECORD_URL=""
ARG AV_WEBAPP_STORAGE_RECORD_SAS_TOKEN=""
ARG AV_WEBAPP_STREAM_URL_PREFIX=""

FROM ubuntu:20.04 
ARG AV_WEBAPP_PORT_HTTP
ARG AV_WEBAPP_STORAGE_RESULT_URL
ARG AV_WEBAPP_STORAGE_RESULT_SAS_TOKEN
ARG AV_WEBAPP_STORAGE_RECORD_URL
ARG AV_WEBAPP_STORAGE_RECORD_SAS_TOKEN
ARG AV_WEBAPP_STREAM_URL_PREFIX

ENV WEBAPP_PORT_HTTP $AV_WEBAPP_PORT_HTTP
ENV WEBAPP_STORAGE_RESULT_URL $AV_WEBAPP_STORAGE_RESULT_URL
ENV WEBAPP_STORAGE_RESULT_SAS_TOKEN $AV_WEBAPP_STORAGE_RESULT_SAS_TOKEN
ENV WEBAPP_STORAGE_RECORD_URL $AV_WEBAPP_STORAGE_RECORD_URL
ENV WEBAPP_STORAGE_RECORD_SAS_TOKEN $AV_WEBAPP_STORAGE_RECORD_SAS_TOKEN
ENV WEBAPP_STREAM_URL_PREFIX $AV_WEBAPP_STREAM_URL_PREFIX 

RUN apt-get -y update \
 && apt-get -y install jq nginx

COPY docker-entrypoint.sh /
RUN chmod 0755 /docker-entrypoint.sh 

EXPOSE $WEBAPP_PORT_HTTP/tcp 

COPY build /usr/share/nginx/html

CMD /docker-entrypoint.sh
